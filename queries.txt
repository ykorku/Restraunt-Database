////queries/////

1-
SELECT ITEM_FAMILY.FAMILY_DESC AS CATEGORY,
       SUM(ITEMS_ORDERED.PRICE) AS TOTAL_DOLLAR_AMOUNT,
       COUNT(ITEMS_ORDERED.ITEM_ID) AS TOTAL_QUANTITY_SOLD
FROM MENU_ITEMS
INNER JOIN ITEMS_ORDERED ON MENU_ITEMS.ITEM_ID = ITEMS_ORDERED.ITEM_ID AND MENU_ITEMS.SIZE = ITEMS_ORDERED.SIZE
INNER JOIN [SUB-FAMILY] ON MENU_ITEMS.SUB_FML_ID = [SUB-FAMILY].SUB_FML_ID
INNER JOIN ITEM_FAMILY ON [SUB-FAMILY].FAMILY_ID = ITEM_FAMILY.FAMILY_ID
GROUP BY ITEM_FAMILY.FAMILY_DESC

2-
SELECT [SUB-FAMILY].SF_DESC AS SUB_CATEGORY,
       SUM(ITEMS_ORDERED.PRICE) AS TOTAL_DOLLAR_AMOUNT,
       COUNT(ITEMS_ORDERED.ITEM_ID) AS TOTAL_QUANTITY_SOLD
FROM MENU_ITEMS
INNER JOIN ITEMS_ORDERED 
  ON MENU_ITEMS.ITEM_ID = ITEMS_ORDERED.ITEM_ID 
  AND MENU_ITEMS.SIZE = ITEMS_ORDERED.SIZE
INNER JOIN [SUB-FAMILY] 
  ON MENU_ITEMS.SUB_FML_ID = [SUB-FAMILY].SUB_FML_ID
GROUP BY [SUB-FAMILY].SF_DESC

3-
SELECT MENU_ITEMS.ITEM_ID, MENU_ITEMS.SIZE, [SUB-FAMILY].SF_DESC,
       SUM(ITEMS_ORDERED.PRICE) AS TOTAL_DOLLAR_AMOUNT,
       COUNT(ITEMS_ORDERED.ITEM_ID) AS TOTAL_QUANTITY_SOLD
FROM MENU_ITEMS
INNER JOIN ITEMS_ORDERED ON MENU_ITEMS.ITEM_ID = ITEMS_ORDERED.ITEM_ID AND MENU_ITEMS.SIZE = ITEMS_ORDERED.SIZE
INNER JOIN [SUB-FAMILY] ON MENU_ITEMS.SUB_FML_ID = [SUB-FAMILY].SUB_FML_ID
INNER JOIN ITEM_FAMILY ON [SUB-FAMILY].FAMILY_ID = ITEM_FAMILY.FAMILY_ID
WHERE ITEM_FAMILY.FAMILY_DESC = 'Pizza'
GROUP BY MENU_ITEMS.ITEM_ID, MENU_ITEMS.SIZE, [SUB-FAMILY].SF_DESC

4-
SELECT MENU_ITEMS.ITEM_ID, MENU_ITEMS.SIZE, [SUB-FAMILY].SF_DESC,
       SUM(ITEMS_ORDERED.PRICE) AS TOTAL_DOLLAR_AMOUNT,
       COUNT(ITEMS_ORDERED.ITEM_ID) AS TOTAL_QUANTITY_SOLD
FROM MENU_ITEMS
INNER JOIN ITEMS_ORDERED ON MENU_ITEMS.ITEM_ID = ITEMS_ORDERED.ITEM_ID AND MENU_ITEMS.SIZE = ITEMS_ORDERED.SIZE
INNER JOIN [SUB-FAMILY] ON [SUB-FAMILY].SUB_FML_ID= MENU_ITEMS.SUB_FML_ID
GROUP BY MENU_ITEMS.ITEM_ID, MENU_ITEMS.SIZE, [SUB-FAMILY].SF_DESC

5-
SELECT ITEM_FAMILY.FAMILY_DESC, [SUB-FAMILY].SF_DESC, MENU_ITEMS.SIZE
FROM MENU_ITEMS
INNER JOIN [SUB-FAMILY] ON MENU_ITEMS.SUB_FML_ID = [SUB-FAMILY].SUB_FML_ID
INNER JOIN ITEM_FAMILY ON [SUB-FAMILY].FAMILY_ID = ITEM_FAMILY.FAMILY_ID

6-
SELECT AVG(PIZZA_COUNT) AS AVERAGE_PIZZA_COUNT
FROM (
  SELECT ORDER_ID, COUNT(*) AS PIZZA_COUNT
  FROM ITEMS_ORDERED
  INNER JOIN MENU_ITEMS ON ITEMS_ORDERED.ITEM_ID = MENU_ITEMS.ITEM_ID AND ITEMS_ORDERED.SIZE = MENU_ITEMS.SIZE
  INNER JOIN [SUB-FAMILY] ON MENU_ITEMS.SUB_FML_ID = [SUB-FAMILY].SUB_FML_ID
  INNER JOIN ITEM_FAMILY ON [SUB-FAMILY].FAMILY_ID = ITEM_FAMILY.FAMILY_ID
  WHERE ITEM_FAMILY.FAMILY_DESC LIKE '%Pizza%'
  GROUP BY ORDER_ID
) PIZZA_ORDERS

7-
SELECT ITEM_FAMILY.FAMILY_DESC, AVG(MENU_ITEMS.PRICE) AS AVG_PRICE
FROM MENU_ITEMS
INNER JOIN [SUB-FAMILY] ON MENU_ITEMS.SUB_FML_ID = [SUB-FAMILY].SUB_FML_ID
INNER JOIN ITEM_FAMILY ON [SUB-FAMILY].FAMILY_ID = ITEM_FAMILY.FAMILY_ID
GROUP BY ITEM_FAMILY.FAMILY_DESC

8-
SELECT DISTINCT CUSTOMER.CUS_ID, CUSTOMER.CUS_FNAME, CUSTOMER.CUS_LNAME
FROM CUSTOMER
INNER JOIN ORDERS ON CUSTOMER.CUS_ID = ORDERS.CUS_ID
INNER JOIN ITEMS_ORDERED ON ORDERS.ORDER_ID = ITEMS_ORDERED.ORDER_ID
INNER JOIN MENU_ITEMS ON ITEMS_ORDERED.ITEM_ID = MENU_ITEMS.ITEM_ID AND ITEMS_ORDERED.SIZE = MENU_ITEMS.SIZE
INNER JOIN [SUB-FAMILY] ON MENU_ITEMS.SUB_FML_ID= [SUB-FAMILY].SUB_FML_ID
WHERE [SUB-FAMILY].SF_DESC LIKE '%Pizza%' OR [SUB-FAMILY].SF_DESC LIKE '%Pasta%'


9-
SELECT [SUB-FAMILY].SF_DESC, COUNT(ITEMS_ORDERED.ITEM_ID) AS TOTAL_QTY_SOLD
FROM ITEMS_ORDERED
INNER JOIN MENU_ITEMS ON ITEMS_ORDERED.ITEM_ID = MENU_ITEMS.ITEM_ID AND ITEMS_ORDERED.SIZE = MENU_ITEMS.SIZE
INNER JOIN [SUB-FAMILY] ON [SUB-FAMILY].SUB_FML_ID=MENU_ITEMS.SUB_FML_ID
GROUP BY [SUB-FAMILY].SF_DESC
HAVING COUNT(ITEMS_ORDERED.ITEM_ID) > (SELECT AVG(TOTAL_QTY_SOLD) FROM(
    SELECT [SUB-FAMILY].SF_DESC, COUNT(ITEMS_ORDERED.ITEM_ID) AS TOTAL_QTY_SOLD
    FROM ITEMS_ORDERED
    INNER JOIN MENU_ITEMS ON ITEMS_ORDERED.ITEM_ID = MENU_ITEMS.ITEM_ID AND ITEMS_ORDERED.SIZE = MENU_ITEMS.SIZE
    INNER JOIN [SUB-FAMILY] ON [SUB-FAMILY].SUB_FML_ID=MENU_ITEMS.SUB_FML_ID
    GROUP BY [SUB-FAMILY].SF_DESC
) AS SUBQUERY)



10-
SELECT MENU_ITEMS.ITEM_ID, MENU_ITEMS.SIZE, ITEMS_ORDERED.PRICE AS SALES_PRICE, AVG(MENU_ITEMS.PRICE) AS AVG_PRICE_ITEM, 
ITEMS_ORDERED.PRICE - MENU_ITEMS.PRICE AS PRICE_DIFF
FROM MENU_ITEMS
JOIN ITEMS_ORDERED  ON MENU_ITEMS.ITEM_ID = ITEMS_ORDERED.ITEM_ID AND MENU_ITEMS.SIZE = ITEMS_ORDERED.SIZE
GROUP BY MENU_ITEMS.ITEM_ID, MENU_ITEMS.SIZE, ITEMS_ORDERED.PRICE, MENU_ITEMS.PRICE
